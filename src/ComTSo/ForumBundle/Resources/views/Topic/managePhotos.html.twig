{% extends 'ComTSoForumBundle:Topic:layout.html.twig' %}

{% block topic_actions %}
    <div class="btn-group pull-right">
        <a href="{{ topic|path }}" class="btn btn-default"><i class="fa fa-arrow-left"></i> Retour</a>
    </div>
{% endblock %}

{% block inner_content %}
    {% spaceless %}
        {% if topic.photos %}
            <div class="topic-photos" id="sortable-photos">
                {% for photoTopic in topic.photos %}
                    {% set photo = photoTopic.photo %}
                    {% if photo %}
                        {% include 'ComTSoForumBundle:Photo:thumbnail.html.twig' %}
                    {% endif %}
                {% endfor %}
                <div class="clear"></div>
            </div>
        {% endif %}
    {% endspaceless %}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        $(document).ready(function(){
            var timeout = null;
            $('#sortable-photos').sortable({
                scroll: true,
                update: function(e, ui) {
                    var t = $(e.target);
                    if (timeout) {
                        window.clearTimeout(timeout);
                    }
                    timeout = window.setTimeout(function() {
                        updatePhotoOrder(t);
                    }, 1000);
                },
                start: function(e, ui) {
                    if (timeout) {
                        window.clearTimeout(timeout);
                    }
                }
            });
        });
    </script>
{% endblock %}
